!function(){"use strict";var e={991:function(e,t,r){e.exports=r.p+"0e2ffe30dd75ea136684.jpg"},728:function(e,t,r){e.exports=r.p+"b16ce179eb109f602d4e.jpg"},675:function(e,t,r){e.exports=r.p+"1a1266facdc7885ad2a1.jpg"},759:function(e,t,r){e.exports=r.p+"1b7e5edb3fd8cc3908ce.jpg"},464:function(e,t,r){e.exports=r.p+"67b7de8779f1a0cb6c6f.jpg"},849:function(e,t,r){e.exports=r.p+"c047f676f3854846bef5.jpg"}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,r),i.exports}r.m=e,r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r.b=document.baseURI||self.location.href,function(){function e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var t=class{constructor(e,t){var r,o;o=()=>this._inputList.some((e=>!e.validity.valid)),(r="_hasInvalidInput")in this?Object.defineProperty(this,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[r]=o,this._config=e,this._formElement=t}_showInputError(e){const{inputErrorClass:t,errorClass:r}=this._config,o=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(t),o.textContent=e.validationMessage,o.classList.add(r)}_hideInputError(e){const{inputErrorClass:t,errorClass:r}=this._config,o=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(t),o.classList.remove(r),o.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_toggleButtonState(e){const{inactiveButtonClass:t}=this._config;this._hasInvalidInput()?(e.classList.add(t),e.disabled=!0):(e.classList.remove(t),e.disabled=!1)}_setEventListeners(){const{inputSelector:e,submitButtonSelector:t}=this._config;this._inputList=Array.from(this._formElement.querySelectorAll(e)),this._buttonElement=this._formElement.querySelector(t),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._buttonElement)}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>e.preventDefault())),this._setEventListeners(),this.resetValidation()}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e)}))}resetForm(){this._formElement.reset(),this._toggleButtonState(this._buttonElement)}};const o=[{cardTitle:"Yellowstone National Park",cardLink:new URL(r(849),r.b)},{cardTitle:"Golden Gate Bridge",cardLink:new URL(r(991),r.b)},{cardTitle:"Statue Of Liberty",cardLink:new URL(r(759),r.b)},{cardTitle:"Grand Canyon",cardLink:new URL(r(728),r.b)},{cardTitle:"Washington Monument",cardLink:new URL(r(464),r.b)},{cardTitle:"Mount-Rushmore",cardLink:new URL(r(675),r.b)}],n={inputSelector:".form__input",submitButtonSelector:".form__submit-button",inactiveButtonClass:"form__submit-button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__input_error_active"},i=document.querySelector(".card-popup"),s=document.querySelector(".card-creator-popup"),a=document.querySelector(".profile-popup"),l={profileName:document.querySelector(".profile__name"),profileAbout:document.querySelector(".profile__about")},u=document.querySelector(".cards"),c={cardPreviewPopup:i,cardPreviewPopupImage:i.querySelector(".card-popup__image"),cardPreviewPopupTitle:i.querySelector(".card-popup__name"),closeCardPreviewPopupButton:i.querySelector(".card-popup__close-button")},p={cardCreatorPopupElement:s,cardCreatorPopupForm:s.querySelector(".form"),cardTitleInput:s.querySelector(".form__input_el_card-title"),cardLinkInput:s.querySelector(".form__input_el_image-link"),openCardCreatorPopupButton:document.getElementById("add"),closeCardCreatorPopupButton:s.querySelector(".popup__close-button")},d={profileEditPopupElement:a,profileEditPopupForm:a.querySelector(".form"),profileNameInput:a.querySelector(".form__input_el_user-name"),profileAboutInput:a.querySelector(".form__input_el_user-about"),openProfileEditPopupButton:document.getElementById("edit"),closeProfileEditPopupButton:a.querySelector(".popup__close-button")};function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var h=class{constructor(e){_(this,"_addEventListeners",(()=>{document.addEventListener("keydown",this._handleEscClose),this._popupElement.addEventListener("click",this._handleRemoteClick),this._popupElement.querySelector(".popup__close-button").addEventListener("click",this._handleCloseButton)})),_(this,"_removeEventListeners",(()=>{document.removeEventListener("keydown",this._handleEscClose),this._popupElement.removeEventListener("click",this._handleRemoteClick),this._popupElement.querySelector(".popup__close-button").removeEventListener("click",this._handleCloseButton)})),_(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),_(this,"_handleRemoteClick",(e=>{const t=document.querySelector(".popup__page-overlay");e.target.isEqualNode(t)&&this.close()})),_(this,"_handleCloseButton",(()=>{this.close()})),this._popupElement=e}open(){this._popupElement.classList.add("popup_visible"),this._addEventListeners()}close(){this._popupElement.classList.remove("popup_visible"),this._removeEventListeners()}};function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b=class extends h{constructor(e){let{popupElement:t,handleFormSubmit:r}=e;super(t),f(this,"addSubmitButtonListener",(()=>{this._formElement.addEventListener("submit",this._handlePopupFormSubmit)})),f(this,"removeSubmitButtonListener",(()=>{this._formElement.removeEventListener("submit",this._handlePopupFormSubmit)})),f(this,"_handlePopupFormSubmit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()})),f(this,"_getInputValues",(()=>{const e={};return[...this._formElement.querySelectorAll(".form__input")].forEach((t=>e[t.name]=t.value)),e})),this._handleFormSubmit=r,this._formElement=this._popupElement.querySelector(".form")}open(){super.open(),this.addSubmitButtonListener()}close(){super.close(),this.removeSubmitButtonListener()}};const{profileName:E,profileAbout:v}=l,{cardPreviewPopup:L}=c,{cardCreatorPopupElement:y,cardCreatorPopupForm:S,openCardCreatorPopupButton:g}=p,{profileEditPopupElement:C,profileEditPopupForm:P,profileNameInput:k,profileAboutInput:I,openProfileEditPopupButton:q}=d,w=new t(n,P);w.enableValidation();const B=new t(n,S);B.enableValidation();const x=new class{constructor(e){m(this,"getUserInfo",(()=>({profileName:this._userName.textContent,profileAbout:this._userAbout.textContent}))),m(this,"setUserInfo",(e=>{const{userName:t,userAbout:r}=e;this._userName.textContent=t,this._userAbout.textContent=r}));const{userNameElement:t,userAboutElement:r}=e;this._userName=t,this._userAbout=r}}({userNameElement:E,userAboutElement:v}),T=new class extends h{constructor(){var e,t;super(...arguments),t=e=>{const{cardTitle:t,cardLink:r}=e,{cardPreviewPopupTitle:o,cardPreviewPopupImage:n}=c;o.textContent=t,n.src=r,n.alt="Photo of ".concat(t),super.open()},(e="open")in this?Object.defineProperty(this,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):this.open=t}}(L),A=t=>new class{constructor(t,r){let{data:o,handleCardClick:n}=t;e(this,"_setEventListeners",(()=>{const e=this._cardElement.querySelector(".cards__like-button"),t=this._cardElement.querySelector(".cards__delete-button"),r=this._cardElement.querySelector(".cards__photo");e.addEventListener("click",this._handleLikeButton),t.addEventListener("click",this._handleDeleteButton),r.addEventListener("click",this._handleCardClick)})),e(this,"_handleLikeButton",(e=>{e.target.classList.toggle("cards__like-button_active")})),e(this,"_handleDeleteButton",(()=>{this._cardElement.remove(),this._cardElement=null}));const{cardTitle:i,cardLink:s}=o;this._name=i,this._link=s,this._handleCardClick=n,this._cardTemplateSelector=document.querySelector(r).content}create(){this._cardElement=this._cardTemplateSelector.querySelector(".cards__item").cloneNode(!0);const e={image:this._cardElement.querySelector(".cards__photo"),name:this._cardElement.querySelector(".cards__name")};return e.image.src=this._link,e.name.textContent=this._name,e.image.alt="Photo of ".concat(this._name),this._setEventListeners(e.image),this._cardElement}}({data:t,handleCardClick:()=>{T.open(t)}},"#userCard").create(),N=new b({popupElement:y,handleFormSubmit:e=>{j.addItemToBegin(A(e))}}),F=new b({popupElement:C,handleFormSubmit:e=>{x.setUserInfo(e)}}),j=new class{constructor(e,t){const{items:r,renderer:o}=e;this._renderedItems=r,this._renderer=o,this._container=t}renderItems(){this._renderedItems.forEach((e=>{this._renderer(e)}))}addItemToEnd(e){this._container.append(e)}addItemToBegin(e){this._container.prepend(e)}}({items:o,renderer:e=>{j.addItemToEnd(A(e))}},u);j.renderItems(),g.addEventListener("click",(()=>{B.resetValidation(),B.resetForm(),N.open()})),q.addEventListener("click",(()=>{w.resetValidation();const e=x.getUserInfo();F.open(),k.value=e.profileName,I.value=e.profileAbout}))}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cGFjazovL3dlYl9wcm9qZWN0XzQvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80L3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvd2VicGFjay9ydW50aW1lL2pzb25wIGNodW5rIGxvYWRpbmciLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbl9fd2VicGFja19yZXF1aXJlX18ubSA9IF9fd2VicGFja19tb2R1bGVzX187XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iaiwgcHJvcCkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7IH0iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsIl9fd2VicGFja19yZXF1aXJlX18uYiA9IGRvY3VtZW50LmJhc2VVUkkgfHwgc2VsZi5sb2NhdGlvbi5ocmVmO1xuXG4vLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuLy8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4vLyBbcmVzb2x2ZSwgcmVqZWN0LCBQcm9taXNlXSA9IGNodW5rIGxvYWRpbmcsIDAgPSBjaHVuayBsb2FkZWRcbnZhciBpbnN0YWxsZWRDaHVua3MgPSB7XG5cdDE3OTogMFxufTtcblxuLy8gbm8gY2h1bmsgb24gZGVtYW5kIGxvYWRpbmdcblxuLy8gbm8gcHJlZmV0Y2hpbmdcblxuLy8gbm8gcHJlbG9hZGVkXG5cbi8vIG5vIEhNUlxuXG4vLyBubyBITVIgbWFuaWZlc3RcblxuLy8gbm8gb24gY2h1bmtzIGxvYWRlZFxuXG4vLyBubyBqc29ucCBmdW5jdGlvbiIsImNsYXNzIENhcmQge1xyXG4gICAgY29uc3RydWN0b3Ioe2RhdGEsIGhhbmRsZUNhcmRDbGlja30sIGNhcmRUZW1wbGF0ZVNlbGVjdG9yKSB7XHJcbiAgICAgICAgY29uc3QgeyBjYXJkVGl0bGUsIGNhcmRMaW5rIH0gPSBkYXRhO1xyXG4gICAgICAgIHRoaXMuX25hbWUgPSBjYXJkVGl0bGU7XHJcbiAgICAgICAgdGhpcy5fbGluayA9IGNhcmRMaW5rO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcclxuICAgICAgICB0aGlzLl9jYXJkVGVtcGxhdGVTZWxlY3RvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY2FyZFRlbXBsYXRlU2VsZWN0b3IpLmNvbnRlbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlKCkge1xyXG4gICAgICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fY2FyZFRlbXBsYXRlU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5jYXJkc19faXRlbVwiKS5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgICAgIGNvbnN0IGNhcmQgPSB7XHJcbiAgICAgICAgICAgIGltYWdlOiB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19waG90b1wiKSxcclxuICAgICAgICAgICAgbmFtZTogdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbmFtZVwiKVxyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIGNhcmQuaW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgICAgICBjYXJkLm5hbWUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgICAgIGNhcmQuaW1hZ2UuYWx0ID0gYFBob3RvIG9mICR7dGhpcy5fbmFtZX1gO1xyXG5cclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycyhjYXJkLmltYWdlKTtcclxuICAgIFxyXG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgICAgIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2RlbGV0ZS1idXR0b25cIik7XHJcbiAgICAgICAgY29uc3QgY2FyZEltYWdlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fcGhvdG9cIik7XHJcblxyXG4gICAgICAgIGxpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUxpa2VCdXR0b24pO1xyXG4gICAgICAgIGRlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uKTtcclxuICAgICAgICBjYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUNhcmRDbGljayk7XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUxpa2VCdXR0b24gPSAoZXZ0KSA9PiB7XHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZHNfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGFuZGxlRGVsZXRlQnV0dG9uID0gKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQ2FyZDsiLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLl9jb25maWcgPSBjb25maWc7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3Qge1xyXG4gICAgICAgICAgICBpbnB1dEVycm9yQ2xhc3MsXHJcbiAgICAgICAgICAgIGVycm9yQ2xhc3NcclxuICAgICAgICB9ID0gdGhpcy5fY29uZmlnOyBcclxuXHJcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKGVycm9yQ2xhc3MpO1xyXG4gICAgfVxyXG5cclxuICAgIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCB7XHJcbiAgICAgICAgICAgIGlucHV0RXJyb3JDbGFzcyxcclxuICAgICAgICAgICAgZXJyb3JDbGFzc1xyXG4gICAgICAgIH0gPSB0aGlzLl9jb25maWc7XHJcblxyXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShpbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICB9XHJcblxyXG4gICAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICBpZighaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2hhc0ludmFsaWRJbnB1dCA9ICgpID0+IHRoaXMuX2lucHV0TGlzdC5zb21lKGlucHV0RWxlbWVudCA9PiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKTtcclxuXHJcbiAgICBfdG9nZ2xlQnV0dG9uU3RhdGUoYnV0dG9uRWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IHsgaW5hY3RpdmVCdXR0b25DbGFzcyB9ID0gdGhpcy5fY29uZmlnO1xyXG4gICAgXHJcbiAgICAgICAgaWYodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICAgICAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIGNvbnN0IHsgaW5wdXRTZWxlY3Rvciwgc3VibWl0QnV0dG9uU2VsZWN0b3IgfSA9IHRoaXMuX2NvbmZpZztcclxuICAgIFxyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChpbnB1dFNlbGVjdG9yKSk7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3Ioc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgXHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goaW5wdXRFbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKHRoaXMuX2J1dHRvbkVsZW1lbnQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZXZ0ID0+IGV2dC5wcmV2ZW50RGVmYXVsdCgpKTtcclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHRoaXMucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKGlucHV0RWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVzZXRGb3JtKCkge1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnJlc2V0KCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUodGhpcy5fYnV0dG9uRWxlbWVudCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XHJcbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAgICB7XHJcbiAgICAgICAgY2FyZFRpdGxlOiBcIlllbGxvd3N0b25lIE5hdGlvbmFsIFBhcmtcIixcclxuICAgICAgICBjYXJkTGluazogbmV3IFVSTChcIi4uL2ltYWdlcy95ZWxsb3dzdG9uZS1uYXRpb25hbC1wYXJrLmpwZ1wiLCBpbXBvcnQubWV0YS51cmwpXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIGNhcmRUaXRsZTogXCJHb2xkZW4gR2F0ZSBCcmlkZ2VcIixcclxuICAgICAgICBjYXJkTGluazogbmV3IFVSTChcIi4uL2ltYWdlcy9nb2xkZW4tZ2F0ZS1icmlkZ2UuanBnXCIsIGltcG9ydC5tZXRhLnVybClcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgY2FyZFRpdGxlOiBcIlN0YXR1ZSBPZiBMaWJlcnR5XCIsXHJcbiAgICAgICAgY2FyZExpbms6IG5ldyBVUkwoXCIuLi9pbWFnZXMvc3RhdHVlLW9mLWxpYmVydHkuanBnXCIsIGltcG9ydC5tZXRhLnVybClcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgY2FyZFRpdGxlOiBcIkdyYW5kIENhbnlvblwiLFxyXG4gICAgICAgIGNhcmRMaW5rOiBuZXcgVVJMKFwiLi4vaW1hZ2VzL2dyYW5kLWNhbnlvbi5qcGdcIiwgaW1wb3J0Lm1ldGEudXJsKVxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBjYXJkVGl0bGU6IFwiV2FzaGluZ3RvbiBNb251bWVudFwiLFxyXG4gICAgICAgIGNhcmRMaW5rOiBuZXcgVVJMKFwiLi4vaW1hZ2VzL3dhc2hpbmd0b24tbW9udW1lbnQuanBnXCIsIGltcG9ydC5tZXRhLnVybClcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgY2FyZFRpdGxlOiBcIk1vdW50LVJ1c2htb3JlXCIsXHJcbiAgICAgICAgY2FyZExpbms6IG5ldyBVUkwoXCIuLi9pbWFnZXMvbW91bnQtcnVzaG1vcmUuanBnXCIsIGltcG9ydC5tZXRhLnVybClcclxuICAgIH1cclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XHJcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxyXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLmZvcm1fX3N1Ym1pdC1idXR0b25cIixcclxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxyXG4gICAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICAgIGVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfZXJyb3JfYWN0aXZlXCJcclxufVxyXG5cclxuY29uc3QgY2FyZFByZXZpZXdQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZC1wb3B1cFwiKTtcclxuY29uc3QgY2FyZENyZWF0b3JQb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmQtY3JlYXRvci1wb3B1cFwiKTtcclxuY29uc3QgcHJvZmlsZUVkaXRQb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZS1wb3B1cCcpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVJbmZvRWxlbWVudHMgPSB7XHJcbiAgICBwcm9maWxlTmFtZTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX25hbWUnKSxcclxuICAgIHByb2ZpbGVBYm91dDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2Fib3V0JylcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNhcmRHcmlkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc1wiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBjYXJkUHJldmlld1BvcHVwRWxlbWVudHMgPSB7XHJcbiAgICBjYXJkUHJldmlld1BvcHVwLFxyXG4gICAgY2FyZFByZXZpZXdQb3B1cEltYWdlOiBjYXJkUHJldmlld1BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZC1wb3B1cF9faW1hZ2VcIiksXHJcbiAgICBjYXJkUHJldmlld1BvcHVwVGl0bGU6IGNhcmRQcmV2aWV3UG9wdXAucXVlcnlTZWxlY3RvcihcIi5jYXJkLXBvcHVwX19uYW1lXCIpLFxyXG4gICAgY2xvc2VDYXJkUHJldmlld1BvcHVwQnV0dG9uOiBjYXJkUHJldmlld1BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZC1wb3B1cF9fY2xvc2UtYnV0dG9uXCIpXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBjYXJkQ3JlYXRvclBvcHVwRWxlbWVudHMgPSB7XHJcbiAgICBjYXJkQ3JlYXRvclBvcHVwRWxlbWVudCxcclxuICAgIGNhcmRDcmVhdG9yUG9wdXBGb3JtOiBjYXJkQ3JlYXRvclBvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIiksXHJcbiAgICBjYXJkVGl0bGVJbnB1dDogY2FyZENyZWF0b3JQb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX19pbnB1dF9lbF9jYXJkLXRpdGxlXCIpLFxyXG4gICAgY2FyZExpbmtJbnB1dDogY2FyZENyZWF0b3JQb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX19pbnB1dF9lbF9pbWFnZS1saW5rXCIpLFxyXG4gICAgb3BlbkNhcmRDcmVhdG9yUG9wdXBCdXR0b246IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkXCIpLFxyXG4gICAgY2xvc2VDYXJkQ3JlYXRvclBvcHVwQnV0dG9uOiBjYXJkQ3JlYXRvclBvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZS1idXR0b25cIilcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0UG9wdXBFbGVtZW50cyA9IHtcclxuICAgIHByb2ZpbGVFZGl0UG9wdXBFbGVtZW50LFxyXG4gICAgcHJvZmlsZUVkaXRQb3B1cEZvcm06IHByb2ZpbGVFZGl0UG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKSxcclxuICAgIHByb2ZpbGVOYW1lSW5wdXQ6IHByb2ZpbGVFZGl0UG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX19pbnB1dF9lbF91c2VyLW5hbWUnKSxcclxuICAgIHByb2ZpbGVBYm91dElucHV0OiBwcm9maWxlRWRpdFBvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZm9ybV9faW5wdXRfZWxfdXNlci1hYm91dCcpLFxyXG4gICAgb3BlblByb2ZpbGVFZGl0UG9wdXBCdXR0b246IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0JyksXHJcbiAgICBjbG9zZVByb2ZpbGVFZGl0UG9wdXBCdXR0b246IHByb2ZpbGVFZGl0UG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY2xvc2UtYnV0dG9uJylcclxufSIsImNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwRWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IHBvcHVwRWxlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfdmlzaWJsZVwiKTtcclxuICAgICAgICB0aGlzLl9hZGRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX3Zpc2libGVcIik7XHJcbiAgICAgICAgdGhpcy5fcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBfYWRkRXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlUmVtb3RlQ2xpY2spO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZS1idXR0b25cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUNsb3NlQnV0dG9uKTtcclxuICAgIH1cclxuXHJcbiAgICBfcmVtb3ZlRXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlUmVtb3RlQ2xpY2spO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZS1idXR0b25cIikucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUNsb3NlQnV0dG9uKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgICAgIGlmKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfaGFuZGxlUmVtb3RlQ2xpY2sgPSAoZXZ0KSA9PiB7XHJcbiAgICAgICAgY29uc3Qgb3V0c2lkZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19wYWdlLW92ZXJsYXlcIik7XHJcblxyXG4gICAgICAgIGlmKGV2dC50YXJnZXQuaXNFcXVhbE5vZGUob3V0c2lkZUVsZW1lbnQpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUNsb3NlQnV0dG9uID0gKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXA7IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IoeyBwb3B1cEVsZW1lbnQsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwRWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIG9wZW4oKSB7XHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgICAgIHRoaXMuYWRkU3VibWl0QnV0dG9uTGlzdGVuZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgICAgIHRoaXMucmVtb3ZlU3VibWl0QnV0dG9uTGlzdGVuZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRTdWJtaXRCdXR0b25MaXN0ZW5lciA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVBvcHVwRm9ybVN1Ym1pdCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlU3VibWl0QnV0dG9uTGlzdGVuZXIgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9oYW5kbGVQb3B1cEZvcm1TdWJtaXQpO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVQb3B1cEZvcm1TdWJtaXQgPSAoZXZ0KSA9PiB7XHJcbiAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBfZ2V0SW5wdXRWYWx1ZXMgPSAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IHt9O1xyXG4gICAgICAgIGNvbnN0IGlucHV0cyA9IFsuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvcm1fX2lucHV0XCIpXTtcclxuXHJcbiAgICAgICAgaW5wdXRzLmZvckVhY2goaW5wdXQgPT4gZGF0YVtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEZvcm07IiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvblwiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IHsgXHJcbiAgICBwcm9maWxlSW5mb0VsZW1lbnRzLCBcclxuICAgIGNhcmRQcmV2aWV3UG9wdXBFbGVtZW50cywgXHJcbiAgICBjYXJkQ3JlYXRvclBvcHVwRWxlbWVudHMsIFxyXG4gICAgcHJvZmlsZUVkaXRQb3B1cEVsZW1lbnRzLFxyXG4gICAgaW5pdGlhbENhcmRzLFxyXG4gICAgY2FyZEdyaWQsXHJcbiAgICBjb25maWdcclxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzXCI7XHJcblxyXG5cclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZVwiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtXCI7XHJcblxyXG5jb25zdCB7IHByb2ZpbGVOYW1lLCBwcm9maWxlQWJvdXQgfSA9IHByb2ZpbGVJbmZvRWxlbWVudHM7XHJcblxyXG5jb25zdCB7IGNhcmRQcmV2aWV3UG9wdXAgfSA9IGNhcmRQcmV2aWV3UG9wdXBFbGVtZW50cztcclxuXHJcbmNvbnN0IHsgXHJcbiAgICBjYXJkQ3JlYXRvclBvcHVwRWxlbWVudCxcclxuICAgIGNhcmRDcmVhdG9yUG9wdXBGb3JtLCBcclxuICAgIG9wZW5DYXJkQ3JlYXRvclBvcHVwQnV0dG9uLFxyXG5cclxufSA9IGNhcmRDcmVhdG9yUG9wdXBFbGVtZW50cztcclxuXHJcbmNvbnN0IHtcclxuICAgIHByb2ZpbGVFZGl0UG9wdXBFbGVtZW50LCBcclxuICAgIHByb2ZpbGVFZGl0UG9wdXBGb3JtLCBcclxuICAgIHByb2ZpbGVOYW1lSW5wdXQsIFxyXG4gICAgcHJvZmlsZUFib3V0SW5wdXQsXHJcbiAgICBvcGVuUHJvZmlsZUVkaXRQb3B1cEJ1dHRvbixcclxuXHJcbn0gPSBwcm9maWxlRWRpdFBvcHVwRWxlbWVudHM7XHJcblxyXG5jb25zdCBwcm9maWxlRWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHByb2ZpbGVFZGl0UG9wdXBGb3JtKTtcclxucHJvZmlsZUVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmNvbnN0IGNhcmRDcmVhdG9yRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgY2FyZENyZWF0b3JQb3B1cEZvcm0pO1xyXG5jYXJkQ3JlYXRvckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gICAgdXNlck5hbWVFbGVtZW50OiBwcm9maWxlTmFtZSxcclxuICAgIHVzZXJBYm91dEVsZW1lbnQ6IHByb2ZpbGVBYm91dFxyXG59KTtcclxuXHJcbmNvbnN0IHBvcHVwSW1hZ2VQcmV2aWV3ID0gbmV3IFBvcHVwV2l0aEltYWdlKGNhcmRQcmV2aWV3UG9wdXApO1xyXG5cclxuY29uc3QgY3JlYXRlQ2FyZCA9IChkYXRhKSA9PiB7XHJcbiAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoe1xyXG4gICAgICAgIGRhdGEsIFxyXG4gICAgICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4ge1xyXG4gICAgICAgICAgICBwb3B1cEltYWdlUHJldmlldy5vcGVuKGRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgIH0sIFwiI3VzZXJDYXJkXCIpO1xyXG4gICAgXHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuY3JlYXRlKCk7XHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn1cclxuXHJcbmNvbnN0IGNhcmRDcmVhdG9yUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XHJcbiAgICBwb3B1cEVsZW1lbnQ6IGNhcmRDcmVhdG9yUG9wdXBFbGVtZW50LFxyXG4gICAgaGFuZGxlRm9ybVN1Ym1pdDogKGRhdGEpID0+IHtcclxuICAgICAgICBjYXJkTGlzdC5hZGRJdGVtVG9CZWdpbihjcmVhdGVDYXJkKGRhdGEpKTtcclxuICAgIH1cclxufSk7XHJcblxyXG5jb25zdCBwcm9maWxlRWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gICAgcG9wdXBFbGVtZW50OiBwcm9maWxlRWRpdFBvcHVwRWxlbWVudCxcclxuICAgIGhhbmRsZUZvcm1TdWJtaXQ6IChkYXRhKSA9PiB7XHJcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oZGF0YSk7XHJcbiAgICB9XHJcbn0pXHJcblxyXG5jb25zdCBjYXJkTGlzdCA9IG5ldyBTZWN0aW9uKHtcclxuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsIFxyXG4gICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XHJcbiAgICAgICAgY2FyZExpc3QuYWRkSXRlbVRvRW5kKGNyZWF0ZUNhcmQoZGF0YSkpO1xyXG4gICAgfVxyXG59LCBjYXJkR3JpZCk7XHJcblxyXG5jYXJkTGlzdC5yZW5kZXJJdGVtcygpO1xyXG5cclxub3BlbkNhcmRDcmVhdG9yUG9wdXBCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGNhcmRDcmVhdG9yRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICAgIGNhcmRDcmVhdG9yRm9ybVZhbGlkYXRvci5yZXNldEZvcm0oKTtcclxuICAgIGNhcmRDcmVhdG9yUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbm9wZW5Qcm9maWxlRWRpdFBvcHVwQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBwcm9maWxlRWRpdEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgICBjb25zdCBkYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICAgIHByb2ZpbGVFZGl0UG9wdXAub3BlbigpO1xyXG5cclxuICAgIHByb2ZpbGVOYW1lSW5wdXQudmFsdWUgPSBkYXRhLnByb2ZpbGVOYW1lO1xyXG4gICAgcHJvZmlsZUFib3V0SW5wdXQudmFsdWUgPSBkYXRhLnByb2ZpbGVBYm91dDtcclxufSk7IiwiY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IoZGF0YSkge1xyXG4gICAgICAgIGNvbnN0IHsgdXNlck5hbWVFbGVtZW50LCB1c2VyQWJvdXRFbGVtZW50IH0gPSBkYXRhO1xyXG4gICAgICAgIHRoaXMuX3VzZXJOYW1lID0gdXNlck5hbWVFbGVtZW50O1xyXG4gICAgICAgIHRoaXMuX3VzZXJBYm91dCA9IHVzZXJBYm91dEVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VXNlckluZm8gPSAoKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcHJvZmlsZU5hbWU6IHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50LFxyXG4gICAgICAgICAgICBwcm9maWxlQWJvdXQ6IHRoaXMuX3VzZXJBYm91dC50ZXh0Q29udGVudFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW5mbyA9IChkYXRhKSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyB1c2VyTmFtZSwgdXNlckFib3V0IH0gPSBkYXRhO1xyXG5cclxuICAgICAgICB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCA9IHVzZXJOYW1lO1xyXG4gICAgICAgIHRoaXMuX3VzZXJBYm91dC50ZXh0Q29udGVudCA9IHVzZXJBYm91dDtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgVXNlckluZm87IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcbmltcG9ydCB7IGNhcmRQcmV2aWV3UG9wdXBFbGVtZW50cyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHNcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgb3BlbiA9IChkYXRhKSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyBjYXJkVGl0bGUsIGNhcmRMaW5rIH0gPSBkYXRhO1xyXG4gICAgICAgIGNvbnN0IHsgY2FyZFByZXZpZXdQb3B1cFRpdGxlLCBjYXJkUHJldmlld1BvcHVwSW1hZ2UgfSA9IGNhcmRQcmV2aWV3UG9wdXBFbGVtZW50cztcclxuXHJcbiAgICAgICAgY2FyZFByZXZpZXdQb3B1cFRpdGxlLnRleHRDb250ZW50ID0gY2FyZFRpdGxlO1xyXG4gICAgICAgIGNhcmRQcmV2aWV3UG9wdXBJbWFnZS5zcmMgPSBjYXJkTGluaztcclxuICAgICAgICBjYXJkUHJldmlld1BvcHVwSW1hZ2UuYWx0ID0gYFBob3RvIG9mICR7Y2FyZFRpdGxlfWA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTsiLCJjbGFzcyBTZWN0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKGRhdGEsIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICAgICAgY29uc3QgeyBpdGVtcywgcmVuZGVyZXIgfSA9IGRhdGE7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZWRJdGVtcyA9IGl0ZW1zO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyU2VsZWN0b3I7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZWRJdGVtcy5mb3JFYWNoKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlcihkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRJdGVtVG9FbmQoZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkSXRlbVRvQmVnaW4oZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBTZWN0aW9uOyJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsIm0iLCJvIiwib2JqIiwicHJvcCIsIk9iamVjdCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInAiLCJiIiwiZG9jdW1lbnQiLCJiYXNlVVJJIiwic2VsZiIsImxvY2F0aW9uIiwiaHJlZiIsImNvbnN0cnVjdG9yIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX2lucHV0TGlzdCIsInNvbWUiLCJpbnB1dEVsZW1lbnQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NvbmZpZyIsIl9mb3JtRWxlbWVudCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJlcnJvckVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwicmVtb3ZlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImJ1dHRvbkVsZW1lbnQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2hhc0ludmFsaWRJbnB1dCIsImRpc2FibGVkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9idXR0b25FbGVtZW50IiwiZm9yRWFjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJyZXNldEZvcm0iLCJyZXNldCIsImluaXRpYWxDYXJkcyIsImNhcmRUaXRsZSIsImNhcmRMaW5rIiwiVVJMIiwiY2FyZFByZXZpZXdQb3B1cCIsImNhcmRDcmVhdG9yUG9wdXBFbGVtZW50IiwicHJvZmlsZUVkaXRQb3B1cEVsZW1lbnQiLCJwcm9maWxlSW5mb0VsZW1lbnRzIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlQWJvdXQiLCJjYXJkR3JpZCIsImNhcmRQcmV2aWV3UG9wdXBFbGVtZW50cyIsImNhcmRQcmV2aWV3UG9wdXBJbWFnZSIsImNhcmRQcmV2aWV3UG9wdXBUaXRsZSIsImNsb3NlQ2FyZFByZXZpZXdQb3B1cEJ1dHRvbiIsImNhcmRDcmVhdG9yUG9wdXBFbGVtZW50cyIsImNhcmRDcmVhdG9yUG9wdXBGb3JtIiwiY2FyZFRpdGxlSW5wdXQiLCJjYXJkTGlua0lucHV0Iiwib3BlbkNhcmRDcmVhdG9yUG9wdXBCdXR0b24iLCJnZXRFbGVtZW50QnlJZCIsImNsb3NlQ2FyZENyZWF0b3JQb3B1cEJ1dHRvbiIsInByb2ZpbGVFZGl0UG9wdXBFbGVtZW50cyIsInByb2ZpbGVFZGl0UG9wdXBGb3JtIiwicHJvZmlsZU5hbWVJbnB1dCIsInByb2ZpbGVBYm91dElucHV0Iiwib3BlblByb2ZpbGVFZGl0UG9wdXBCdXR0b24iLCJjbG9zZVByb2ZpbGVFZGl0UG9wdXBCdXR0b24iLCJwb3B1cEVsZW1lbnQiLCJfaGFuZGxlRXNjQ2xvc2UiLCJfcG9wdXBFbGVtZW50IiwiX2hhbmRsZVJlbW90ZUNsaWNrIiwiX2hhbmRsZUNsb3NlQnV0dG9uIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsImNsb3NlIiwib3V0c2lkZUVsZW1lbnQiLCJ0YXJnZXQiLCJpc0VxdWFsTm9kZSIsIm9wZW4iLCJfYWRkRXZlbnRMaXN0ZW5lcnMiLCJfcmVtb3ZlRXZlbnRMaXN0ZW5lcnMiLCJQb3B1cCIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVQb3B1cEZvcm1TdWJtaXQiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsImRhdGEiLCJpbnB1dCIsIm5hbWUiLCJ2YWx1ZSIsImFkZFN1Ym1pdEJ1dHRvbkxpc3RlbmVyIiwicmVtb3ZlU3VibWl0QnV0dG9uTGlzdGVuZXIiLCJwcm9maWxlRWRpdEZvcm1WYWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiY2FyZENyZWF0b3JGb3JtVmFsaWRhdG9yIiwidXNlckluZm8iLCJfdXNlck5hbWUiLCJfdXNlckFib3V0IiwidXNlck5hbWUiLCJ1c2VyQWJvdXQiLCJ1c2VyTmFtZUVsZW1lbnQiLCJ1c2VyQWJvdXRFbGVtZW50IiwicG9wdXBJbWFnZVByZXZpZXciLCJzcmMiLCJhbHQiLCJjcmVhdGVDYXJkIiwiY2FyZFRlbXBsYXRlU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJsaWtlQnV0dG9uIiwiX2NhcmRFbGVtZW50IiwiZGVsZXRlQnV0dG9uIiwiY2FyZEltYWdlIiwiX2hhbmRsZUxpa2VCdXR0b24iLCJfaGFuZGxlRGVsZXRlQnV0dG9uIiwiX2hhbmRsZUNhcmRDbGljayIsInRvZ2dsZSIsIl9uYW1lIiwiX2xpbmsiLCJfY2FyZFRlbXBsYXRlU2VsZWN0b3IiLCJjb250ZW50IiwiY3JlYXRlIiwiY2xvbmVOb2RlIiwiY2FyZCIsImltYWdlIiwiY2FyZENyZWF0b3JQb3B1cCIsIlBvcHVwV2l0aEZvcm0iLCJjYXJkTGlzdCIsImFkZEl0ZW1Ub0JlZ2luIiwicHJvZmlsZUVkaXRQb3B1cCIsInNldFVzZXJJbmZvIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX3JlbmRlcmVkSXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJhZGRJdGVtVG9FbmQiLCJlbGVtZW50IiwiYXBwZW5kIiwicHJlcGVuZCIsImdldFVzZXJJbmZvIl0sInNvdXJjZVJvb3QiOiIifQ==