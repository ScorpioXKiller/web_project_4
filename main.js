!function(){"use strict";function e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const t={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__submit-button",inactiveButtonClass:"form__submit-button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__input_error_active"},r=document.querySelector(".card-popup"),n=document.querySelector(".card-creator-popup"),i=document.querySelector(".profile-popup"),o=document.querySelector(".profile-avatar-popup"),s=document.querySelector(".confirm-popup"),a={profileName:document.querySelector(".profile__name"),profileAbout:document.querySelector(".profile__about"),profileAvatar:document.querySelector(".profile__avatar")},l=(document.querySelector(".profile__avatar-edit-button"),document.querySelector(".cards")),u={cardPreviewPopup:r,cardPreviewPopupImage:r.querySelector(".card-popup__image"),cardPreviewPopupTitle:r.querySelector(".card-popup__name"),closeCardPreviewPopupButton:r.querySelector(".card-popup__close-button")},d={popupConfirmElement:s},c={cardCreatorPopupElement:n,openCardCreatorPopupButton:document.getElementById("add")},h={profileEditPopupElement:i,profileNameInput:i.querySelector(".form__input_el_user-name"),profileAboutInput:i.querySelector(".form__input_el_user-about"),openProfileEditPopupButton:document.getElementById("info-edit")},p={profileAvatarEditPopupElement:o,profileAvatarLinkInput:o.querySelector(".form__input_el_avatar-link"),openProfileAvatarEditPopupButton:document.getElementById("avatar-edit")},m={};function _(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var E=class{constructor(e){f(this,"_addEventListeners",(()=>{document.addEventListener("keydown",this._handleEscClose),this._popupElement.addEventListener("click",this._handleRemoteClick),this._popupElement.querySelector(".popup__close-button").addEventListener("click",this._handleCloseButton)})),f(this,"_removeEventListeners",(()=>{document.removeEventListener("keydown",this._handleEscClose),this._popupElement.removeEventListener("click",this._handleRemoteClick),this._popupElement.querySelector(".popup__close-button").removeEventListener("click",this._handleCloseButton)})),f(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),f(this,"_handleRemoteClick",(e=>{const t=document.querySelector(".popup__page-overlay");e.target.isEqualNode(t)&&this.close()})),f(this,"_handleCloseButton",(()=>{this.close()})),this._popupElement=e}open(){this._popupElement.classList.add("popup_visible"),this._addEventListeners()}close(){this._popupElement.classList.remove("popup_visible"),this._removeEventListeners()}};function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v=class extends E{constructor(e){let{popupElement:t,handleFormSubmit:r}=e;super(t),b(this,"addSubmitButtonListener",(()=>{this._formElement.addEventListener("submit",this._handlePopupFormSubmit)})),b(this,"removeSubmitButtonListener",(()=>{this._formElement.removeEventListener("submit",this._handlePopupFormSubmit)})),b(this,"_handlePopupFormSubmit",(e=>{e.preventDefault(),this._submitButton.textContent="Saving...",this._handleFormSubmit(this._getInputValues(),this._submitButton)})),b(this,"_getInputValues",(()=>{const e={};return[...this._formElement.querySelectorAll(".form__input")].forEach((t=>e[t.name]=t.value)),e})),this._handleFormSubmit=r,this._formElement=this._popupElement.querySelector(".form"),this._submitButton=this._popupElement.querySelector(".form__submit-button")}open(){super.open(),this.addSubmitButtonListener()}close(){super.close(),this.removeSubmitButtonListener()}};function C(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const{profileName:y,profileAbout:S,profileAvatar:L}=a,{cardPreviewPopup:g}=u,{popupConfirmElement:P}=d,{cardCreatorPopupElement:I,openCardCreatorPopupButton:B}=c,{profileEditPopupElement:A,profileNameInput:q,profileAboutInput:w,openProfileEditPopupButton:F}=h,{profileAvatarEditPopupElement:U,openProfileAvatarEditPopupButton:T}=p;let x;const N=new class{constructor(e){let{baseUrl:t,headers:r}=e;k(this,"initAllPromise",(()=>Promise.all([this.getInitialCards(),this.getUserInfo()]))),k(this,"_defaultFetch",((e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject(e.status))).catch((e=>console.log("Error: ".concat(e)))))),this._baseUrl=t,this._headers=r}getUserInfo(){return this._defaultFetch("".concat(this._baseUrl,"/users/me"),{method:"GET",headers:this._headers})}uploadUserInfo(e){return this._defaultFetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",body:JSON.stringify(e),headers:this._headers})}uploadProfileAvatar(e){return this._defaultFetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",body:JSON.stringify({avatar:e}),headers:this._headers})}getInitialCards(){return this._defaultFetch("".concat(this._baseUrl,"/cards"),{method:"GET",headers:this._headers})}uploadCard(e){return this._defaultFetch("".concat(this._baseUrl,"/cards"),{method:"POST",body:JSON.stringify(e),headers:this._headers})}deleteCard(e){return this._defaultFetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers})}likeCard(e){return this._defaultFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers})}dislikeCard(e){return this._defaultFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers})}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"21827e70-d261-4f64-a3bc-4b52f52216ed","Content-Type":"application/json"}});N.initAllPromise().then((e=>{let[t,r]=e;j.setUserInfo({name:r.name,job:r.about,id:r._id}),j.setUserAvatar(r.avatar),x=r._id})),N.getUserInfo().then((e=>{j.setUserInfo({name:e.name,about:e.about})})),N.getInitialCards().then((e=>{console.log(e),D.renderItems(e)}));const j=new class{constructor(e){_(this,"getUserInfo",(()=>({profileName:this._userName.textContent,profileAbout:this._userAbout.textContent}))),_(this,"setUserInfo",(e=>{const{name:t,about:r,id:n}=e;this._userName.textContent=t,this._userAbout.textContent=r,this._userId=n})),_(this,"setUserAvatar",(e=>{this._userAvatar.style.backgroundImage='url("'.concat(e,'")')}));const{userNameElement:t,userAboutElement:r,userAvatarElement:n}=e;this._userName=t,this._userAbout=r,this._userAvatar=n}}({userNameElement:y,userAboutElement:S,userAvatarElement:L}),O=new class extends E{constructor(){var e,t;super(...arguments),t=e=>{const{name:t,link:r}=e,{cardPreviewPopupTitle:n,cardPreviewPopupImage:i}=u;n.textContent=t,i.src=r,i.alt="Photo of ".concat(r),super.open()},(e="open")in this?Object.defineProperty(this,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):this.open=t}}(g),V=new class extends E{constructor(){super(...arguments),C(this,"setAction",(e=>{this._submitButtonHandler=e})),C(this,"open",(()=>{super.open(),this.addConfirmButtonListener()})),C(this,"addConfirmButtonListener",(()=>{this._popupElement.addEventListener("submit",this._handlePopupConfirmButton)})),C(this,"removeConfirmButtonListener",(()=>{this._popupElement.removeEventListener("submit",this._handlePopupConfirmButton)})),C(this,"_handlePopupConfirmButton",(e=>{e.preventDefault(),this._submitButtonHandler()}))}close(){super.close(),this.removeConfirmButtonListener()}}(P),D=new class{constructor(e,t){let{renderer:r}=e;this._renderer=r,this._container=t}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItemToEnd(e){this._container.append(e)}addItemToBegin(e){this._container.prepend(e)}}({renderer:e=>{D.addItemToEnd(H(e))}},l),H=t=>{const r=new class{constructor(t,r,n){let{data:i,handleCardClick:o,handleDeleteCard:s,handleLikeCard:a}=t;e(this,"delete",(()=>{this._cardElement.remove(),this._cardElement=null})),e(this,"isLiked",(()=>this._likes.some((e=>e._id===this._userId)))),e(this,"updateLikes",(e=>{this._likes=e,this._likesAmount.textContent=this._likes.length,this._likeButton.classList.toggle("cards__like-button_active")})),e(this,"_setEventListeners",(()=>{const e=this._cardElement.querySelector(".cards__photo");this._likeButton.addEventListener("click",this._handleLikeCard),this._deleteButton.addEventListener("click",this._handleDeleteCard),e.addEventListener("click",this._handleCardClick)}));const{name:l,link:u,likes:d=[],owner:c={}}=i;this._name=l,this._link=u,this._likes=d,this._ownerId=c._id,this._handleCardClick=o,this._handleDeleteCard=s,this._handleLikeCard=a,this._cardTemplateSelector=document.querySelector(r).content,this._userId=n,this._cardElement=this._cardTemplateSelector.querySelector(".cards__item").cloneNode(!0),this._deleteButton=this._cardElement.querySelector(".cards__delete-button"),this._likeButton=this._cardElement.querySelector(".cards__like-button"),this._likesAmount=this._cardElement.querySelector(".cards__likes-amount"),null==this._ownerId&&(this._ownerId=n)}create(){const e={image:this._cardElement.querySelector(".cards__photo"),name:this._cardElement.querySelector(".cards__name")};return e.image.src=this._link,e.name.textContent=this._name,e.image.alt="Photo of ".concat(this._name),this._setEventListeners(e.image),this._ownerId!==this._userId&&this._deleteButton.classList.add("card__delete-button_hidden"),this._likesAmount.textContent=this._likes.length,this.isLiked()&&(this.updateLikes(this._likes),this._likeButton.title="Dislike"),this._cardElement}}({data:t,handleCardClick:()=>{O.open(t)},handleDeleteCard:()=>{V.open(),V.setAction((()=>{N.deleteCard(t._id).then((()=>{r.delete(),V.close()}))}))},handleLikeCard:()=>{r.isLiked()?N.dislikeCard(t._id).then((e=>{r.updateLikes(e.likes)})):N.likeCard(t._id).then((e=>{r.updateLikes(e.likes)}))}},"#userCard",x);return r.create()},J=new v({popupElement:I,handleFormSubmit:(e,t)=>{N.uploadCard(e).then((()=>{D.addItemToBegin(H(e)),J.close()})).finally(setTimeout((()=>{t.textContent="Create"}),1e3))}}),R=new v({popupElement:A,handleFormSubmit:(e,t)=>{N.uploadUserInfo(e).then((()=>{j.setUserInfo(e),R.close()})).finally(setTimeout((()=>{t.textContent="Save"}),1e3))}}),G=new v({popupElement:U,handleFormSubmit:(e,t)=>{N.uploadProfileAvatar(e.link).then((()=>{j.setUserAvatar(e.link),G.close()})).finally(setTimeout((()=>{t.textContent="Save"}),1e3))}});[...document.querySelectorAll(t.formSelector)].forEach((e=>{const r=new class{constructor(e,t){var r,n;n=()=>this._inputList.some((e=>!e.validity.valid)),(r="_hasInvalidInput")in this?Object.defineProperty(this,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[r]=n,this._config=e,this._formElement=t}_showInputError(e){const{inputErrorClass:t,errorClass:r}=this._config,n=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(t),n.textContent=e.validationMessage,n.classList.add(r)}_hideInputError(e){const{inputErrorClass:t,errorClass:r}=this._config,n=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(t),n.classList.remove(r),n.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_toggleButtonState(e){const{inactiveButtonClass:t}=this._config;this._hasInvalidInput()?(e.classList.add(t),e.disabled=!0):(e.classList.remove(t),e.disabled=!1)}_setEventListeners(){const{inputSelector:e,submitButtonSelector:t}=this._config;this._inputList=Array.from(this._formElement.querySelectorAll(e)),this._buttonElement=this._formElement.querySelector(t),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._buttonElement)}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>e.preventDefault())),this._setEventListeners(),this.resetValidation()}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e)}))}resetFormInputs(){this._formElement.reset(),this._toggleButtonState(this._buttonElement)}}(t,e),n=e.getAttribute("name");m[n]=r,r.enableValidation()})),B.addEventListener("click",(()=>{m.cardCreatorForm.resetValidation(),m.cardCreatorForm.resetFormInputs(),J.open()})),F.addEventListener("click",(()=>{m.profileEditForm.resetValidation();const e=j.getUserInfo();R.open(),q.value=e.profileName,w.value=e.profileAbout})),T.addEventListener("click",(()=>{m.profileAvatarEditForm.resetValidation(),m.profileAvatarEditForm.resetFormInputs(),G.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FBUyxLQUNqREgsRUFBQUEsZ0JBQUFBLGtCQUNBLE1BQU1nQyxFQUFPZ0QsRUFBU2pDLGNBQ3RCK0csRUFBaUI5SSxPQUVqQnRCLEVBQWlCMkMsTUFBUUwsRUFBS25ELFlBQzlCYyxFQUFrQjBDLE1BQVFMLEVBQUtsRCxnQkFHbkNpQixFQUFpQ0ksaUJBQWlCLFNBQVMsS0FDdkRILEVBQUFBLHNCQUFBQSxrQkFDQUEsRUFBQUEsc0JBQUFBLGtCQUNBK0osRUFBdUIvSSxVIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlscy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQ29uZmlybVBvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvRm9ybVZhbGlkYXRvci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gICAgZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsXHJcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxyXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLmZvcm1fX3N1Ym1pdC1idXR0b25cIixcclxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxyXG4gICAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICAgIGVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfZXJyb3JfYWN0aXZlXCJcclxufVxyXG5cclxuY29uc3QgY2FyZFByZXZpZXdQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZC1wb3B1cFwiKTtcclxuY29uc3QgY2FyZENyZWF0b3JQb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmQtY3JlYXRvci1wb3B1cFwiKTtcclxuY29uc3QgcHJvZmlsZUVkaXRQb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZS1wb3B1cCcpO1xyXG5jb25zdCBwcm9maWxlQXZhdGFyRWRpdFBvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZS1hdmF0YXItcG9wdXBcIik7XHJcbmNvbnN0IHBvcHVwQ29uZmlybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbmZpcm0tcG9wdXBcIik7XHJcblxyXG5leHBvcnQgY29uc3QgcHJvZmlsZUluZm9FbGVtZW50cyA9IHtcclxuICAgIHByb2ZpbGVOYW1lOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fbmFtZScpLFxyXG4gICAgcHJvZmlsZUFib3V0OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWJvdXQnKSxcclxuICAgIHByb2ZpbGVBdmF0YXI6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlQXZhdGFyRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWVkaXQtYnV0dG9uXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNhcmRHcmlkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc1wiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBjYXJkUHJldmlld1BvcHVwRWxlbWVudHMgPSB7XHJcbiAgICBjYXJkUHJldmlld1BvcHVwLFxyXG4gICAgY2FyZFByZXZpZXdQb3B1cEltYWdlOiBjYXJkUHJldmlld1BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZC1wb3B1cF9faW1hZ2VcIiksXHJcbiAgICBjYXJkUHJldmlld1BvcHVwVGl0bGU6IGNhcmRQcmV2aWV3UG9wdXAucXVlcnlTZWxlY3RvcihcIi5jYXJkLXBvcHVwX19uYW1lXCIpLFxyXG4gICAgY2xvc2VDYXJkUHJldmlld1BvcHVwQnV0dG9uOiBjYXJkUHJldmlld1BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZC1wb3B1cF9fY2xvc2UtYnV0dG9uXCIpXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBjb25maXJtUG9wdXBFbGVtZW50cyA9IHtcclxuICAgIHBvcHVwQ29uZmlybUVsZW1lbnQsXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBjYXJkQ3JlYXRvclBvcHVwRWxlbWVudHMgPSB7XHJcbiAgICBjYXJkQ3JlYXRvclBvcHVwRWxlbWVudCxcclxuICAgIG9wZW5DYXJkQ3JlYXRvclBvcHVwQnV0dG9uOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFkZFwiKSxcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0UG9wdXBFbGVtZW50cyA9IHtcclxuICAgIHByb2ZpbGVFZGl0UG9wdXBFbGVtZW50LFxyXG4gICAgcHJvZmlsZU5hbWVJbnB1dDogcHJvZmlsZUVkaXRQb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm1fX2lucHV0X2VsX3VzZXItbmFtZScpLFxyXG4gICAgcHJvZmlsZUFib3V0SW5wdXQ6IHByb2ZpbGVFZGl0UG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX19pbnB1dF9lbF91c2VyLWFib3V0JyksXHJcbiAgICBvcGVuUHJvZmlsZUVkaXRQb3B1cEJ1dHRvbjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luZm8tZWRpdCcpLFxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcHJvZmlsZUF2YXRhckVkaXRQb3B1cEVsZW1lbnRzID0ge1xyXG4gICAgcHJvZmlsZUF2YXRhckVkaXRQb3B1cEVsZW1lbnQsXHJcbiAgICBwcm9maWxlQXZhdGFyTGlua0lucHV0OiBwcm9maWxlQXZhdGFyRWRpdFBvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0X2VsX2F2YXRhci1saW5rXCIpLFxyXG4gICAgb3BlblByb2ZpbGVBdmF0YXJFZGl0UG9wdXBCdXR0b246IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXZhdGFyLWVkaXRcIilcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge30iLCJjbGFzcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cEVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBwb3B1cEVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwX3Zpc2libGVcIik7XHJcbiAgICAgICAgdGhpcy5fYWRkRXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF92aXNpYmxlXCIpO1xyXG4gICAgICAgIHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2FkZEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZVJlbW90ZUNsaWNrKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2UtYnV0dG9uXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVDbG9zZUJ1dHRvbik7XHJcbiAgICB9XHJcblxyXG4gICAgX3JlbW92ZUV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZVJlbW90ZUNsaWNrKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2UtYnV0dG9uXCIpLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVDbG9zZUJ1dHRvbik7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgICAgICBpZihldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZVJlbW90ZUNsaWNrID0gKGV2dCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IG91dHNpZGVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fcGFnZS1vdmVybGF5XCIpO1xyXG5cclxuICAgICAgICBpZihldnQudGFyZ2V0LmlzRXF1YWxOb2RlKG91dHNpZGVFbGVtZW50KSkge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVDbG9zZUJ1dHRvbiA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwOyIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHsgcG9wdXBFbGVtZW50LCBoYW5kbGVGb3JtU3VibWl0IH0pIHtcclxuICAgICAgICBzdXBlcihwb3B1cEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX19zdWJtaXQtYnV0dG9uXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIG9wZW4oKSB7XHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgICAgIHRoaXMuYWRkU3VibWl0QnV0dG9uTGlzdGVuZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgICAgIHRoaXMucmVtb3ZlU3VibWl0QnV0dG9uTGlzdGVuZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRTdWJtaXRCdXR0b25MaXN0ZW5lciA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVBvcHVwRm9ybVN1Ym1pdCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlU3VibWl0QnV0dG9uTGlzdGVuZXIgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9oYW5kbGVQb3B1cEZvcm1TdWJtaXQpO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVQb3B1cEZvcm1TdWJtaXQgPSAoZXZ0KSA9PiB7XHJcbiAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCksIHRoaXMuX3N1Ym1pdEJ1dHRvbik7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIF9nZXRJbnB1dFZhbHVlcyA9ICgpID0+IHtcclxuICAgICAgICBjb25zdCBkYXRhID0ge307XHJcbiAgICAgICAgY29uc3QgaW5wdXRzID0gWy4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybV9faW5wdXRcIildO1xyXG5cclxuICAgICAgICBpbnB1dHMuZm9yRWFjaChpbnB1dCA9PiBkYXRhW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWUpO1xyXG5cclxuICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoRm9ybTsiLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL3V0aWxzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IHsgXHJcbiAgICBwcm9maWxlSW5mb0VsZW1lbnRzLCBcclxuICAgIGNhcmRQcmV2aWV3UG9wdXBFbGVtZW50cywgXHJcbiAgICBjYXJkQ3JlYXRvclBvcHVwRWxlbWVudHMsIFxyXG4gICAgcHJvZmlsZUVkaXRQb3B1cEVsZW1lbnRzLFxyXG4gICAgY2FyZEdyaWQsXHJcbiAgICBjb25maWcsXHJcbiAgICBjb25maXJtUG9wdXBFbGVtZW50cyxcclxuICAgIGZvcm1WYWxpZGF0b3JzLFxyXG4gICAgcHJvZmlsZUF2YXRhckVkaXRQb3B1cEVsZW1lbnRzXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50c1wiO1xyXG5cclxuXHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mb1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2VcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybVwiO1xyXG5pbXBvcnQgQ29uZmlybVBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL0NvbmZpcm1Qb3B1cFwiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGlcIjtcclxuXHJcbmNvbnN0IHsgcHJvZmlsZU5hbWUsIHByb2ZpbGVBYm91dCwgcHJvZmlsZUF2YXRhciB9ID0gcHJvZmlsZUluZm9FbGVtZW50cztcclxuXHJcbmNvbnN0IHsgY2FyZFByZXZpZXdQb3B1cCB9ID0gY2FyZFByZXZpZXdQb3B1cEVsZW1lbnRzO1xyXG5cclxuY29uc3QgeyBwb3B1cENvbmZpcm1FbGVtZW50IH0gPSBjb25maXJtUG9wdXBFbGVtZW50cztcclxuXHJcbmNvbnN0IHsgXHJcbiAgICBjYXJkQ3JlYXRvclBvcHVwRWxlbWVudCxcclxuICAgIG9wZW5DYXJkQ3JlYXRvclBvcHVwQnV0dG9uLFxyXG5cclxufSA9IGNhcmRDcmVhdG9yUG9wdXBFbGVtZW50cztcclxuXHJcbmNvbnN0IHtcclxuICAgIHByb2ZpbGVFZGl0UG9wdXBFbGVtZW50LCBcclxuICAgIHByb2ZpbGVOYW1lSW5wdXQsIFxyXG4gICAgcHJvZmlsZUFib3V0SW5wdXQsXHJcbiAgICBvcGVuUHJvZmlsZUVkaXRQb3B1cEJ1dHRvbixcclxuXHJcbn0gPSBwcm9maWxlRWRpdFBvcHVwRWxlbWVudHM7XHJcblxyXG5jb25zdCB7IFxyXG4gICAgcHJvZmlsZUF2YXRhckVkaXRQb3B1cEVsZW1lbnQsXHJcbiAgICBvcGVuUHJvZmlsZUF2YXRhckVkaXRQb3B1cEJ1dHRvblxyXG5cclxufSA9IHByb2ZpbGVBdmF0YXJFZGl0UG9wdXBFbGVtZW50c1xyXG5cclxubGV0IHVzZXJJZDtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gICAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCIyMTgyN2U3MC1kMjYxLTRmNjQtYTNiYy00YjUyZjUyMjE2ZWRcIixcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgIH1cclxufSk7XHJcblxyXG5hcGkuaW5pdEFsbFByb21pc2UoKVxyXG4udGhlbigoW2NhcmRzLCB1c2VyXSkgPT4ge1xyXG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtuYW1lOiB1c2VyLm5hbWUsIGpvYjogdXNlci5hYm91dCwgaWQ6IHVzZXIuX2lkfSk7XHJcbiAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyLmF2YXRhcik7XHJcbiAgdXNlcklkID0gdXNlci5faWQ7XHJcbn0pXHJcblxyXG5hcGkuZ2V0VXNlckluZm8oKVxyXG4gICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7bmFtZTogcmVzLm5hbWUsIGFib3V0OiByZXMuYWJvdXR9KTtcclxuICAgIH0pXHJcblxyXG5hcGkuZ2V0SW5pdGlhbENhcmRzKClcclxuICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgICBjYXJkTGlzdC5yZW5kZXJJdGVtcyhyZXMpO1xyXG4gICAgfSk7XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKCkgPT4gIHtcclxuICAgIGNvbnN0IGZvcm1MaXN0ID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcildO1xyXG4gICAgZm9ybUxpc3QuZm9yRWFjaChmb3JtID0+IHtcclxuICAgICAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGZvcm0pO1xyXG4gICAgICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybS5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xyXG4gICAgICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcclxuICAgICAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcclxuICAgIHVzZXJOYW1lRWxlbWVudDogcHJvZmlsZU5hbWUsXHJcbiAgICB1c2VyQWJvdXRFbGVtZW50OiBwcm9maWxlQWJvdXQsXHJcbiAgICB1c2VyQXZhdGFyRWxlbWVudDogcHJvZmlsZUF2YXRhciBcclxufSk7XHJcblxyXG5jb25zdCBwb3B1cEltYWdlUHJldmlldyA9IG5ldyBQb3B1cFdpdGhJbWFnZShjYXJkUHJldmlld1BvcHVwKTtcclxuY29uc3QgcG9wdXBDb25maXJtID0gbmV3IENvbmZpcm1Qb3B1cChwb3B1cENvbmZpcm1FbGVtZW50KTtcclxuXHJcbmNvbnN0IGNhcmRMaXN0ID0gbmV3IFNlY3Rpb24oe1xyXG4gICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XHJcbiAgICAgICAgY2FyZExpc3QuYWRkSXRlbVRvRW5kKGNyZWF0ZUNhcmQoaXRlbSkpO1xyXG4gICAgfVxyXG59LCBjYXJkR3JpZCk7XHJcblxyXG5jb25zdCBjcmVhdGVDYXJkID0gKGRhdGEpID0+IHtcclxuICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZCh7XHJcbiAgICAgICAgZGF0YSwgXHJcbiAgICAgICAgaGFuZGxlQ2FyZENsaWNrOiAoKSA9PiB7XHJcbiAgICAgICAgICAgIHBvcHVwSW1hZ2VQcmV2aWV3Lm9wZW4oZGF0YSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBoYW5kbGVEZWxldGVDYXJkOiAoKSA9PiB7XHJcbiAgICAgICAgICAgIHBvcHVwQ29uZmlybS5vcGVuKCk7XHJcblxyXG4gICAgICAgICAgICBwb3B1cENvbmZpcm0uc2V0QWN0aW9uKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGFwaS5kZWxldGVDYXJkKGRhdGEuX2lkKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FyZC5kZWxldGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXBDb25maXJtLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaGFuZGxlTGlrZUNhcmQ6ICgpID0+IHtcclxuICAgICAgICAgICAgZGVidWdnZXJcclxuICAgICAgICAgICAgY29uc3QgaGFzTGlrZSA9IGNhcmQuaXNMaWtlZCgpO1xyXG5cclxuICAgICAgICAgICAgaWYoaGFzTGlrZSkge1xyXG4gICAgICAgICAgICAgICAgYXBpLmRpc2xpa2VDYXJkKGRhdGEuX2lkKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmQudXBkYXRlTGlrZXMocmVzLmxpa2VzKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFwaS5saWtlQ2FyZChkYXRhLl9pZClcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJkLnVwZGF0ZUxpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LCBcIiN1c2VyQ2FyZFwiLCB1c2VySWQpO1xyXG4gICAgXHJcbiAgICByZXR1cm4gY2FyZC5jcmVhdGUoKTtcclxufVxyXG5cclxuY29uc3QgY2FyZENyZWF0b3JQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcclxuICAgIHBvcHVwRWxlbWVudDogY2FyZENyZWF0b3JQb3B1cEVsZW1lbnQsXHJcbiAgICBoYW5kbGVGb3JtU3VibWl0OiAoZGF0YSwgYnV0dG9uKSA9PiB7XHJcbiAgICAgICAgYXBpLnVwbG9hZENhcmQoZGF0YSlcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY2FyZExpc3QuYWRkSXRlbVRvQmVnaW4oY3JlYXRlQ2FyZChkYXRhKSk7XHJcbiAgICAgICAgICAgICAgICBjYXJkQ3JlYXRvclBvcHVwLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5maW5hbGx5KChzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9IFwiQ3JlYXRlXCI7XHJcbiAgICAgICAgICAgIH0sIDEwMDApKSk7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxuY29uc3QgcHJvZmlsZUVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcclxuICAgIHBvcHVwRWxlbWVudDogcHJvZmlsZUVkaXRQb3B1cEVsZW1lbnQsXHJcbiAgICBoYW5kbGVGb3JtU3VibWl0OiAoZGF0YSwgYnV0dG9uKSA9PiB7XHJcbiAgICAgICAgYXBpLnVwbG9hZFVzZXJJbmZvKGRhdGEpXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgcHJvZmlsZUVkaXRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuZmluYWxseSgoc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBidXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcclxuICAgICAgICAgICAgfSwgMTAwMCkpKTtcclxuICAgIH1cclxufSlcclxuXHJcbmNvbnN0IHByb2ZpbGVBdmF0YXJFZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XHJcbiAgICBwb3B1cEVsZW1lbnQ6IHByb2ZpbGVBdmF0YXJFZGl0UG9wdXBFbGVtZW50LFxyXG4gICAgaGFuZGxlRm9ybVN1Ym1pdDogKGRhdGEsIGJ1dHRvbikgPT4ge1xyXG4gICAgICAgIGFwaS51cGxvYWRQcm9maWxlQXZhdGFyKGRhdGEubGluaylcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihkYXRhLmxpbmspO1xyXG4gICAgICAgICAgICAgICAgcHJvZmlsZUF2YXRhckVkaXRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuZmluYWxseSgoc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBidXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcclxuICAgICAgICAgICAgfSwgMTAwMCkpKTtcclxuICAgIH1cclxufSlcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbm9wZW5DYXJkQ3JlYXRvclBvcHVwQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBmb3JtVmFsaWRhdG9yc1tcImNhcmRDcmVhdG9yRm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcclxuICAgIGZvcm1WYWxpZGF0b3JzW1wiY2FyZENyZWF0b3JGb3JtXCJdLnJlc2V0Rm9ybUlucHV0cygpO1xyXG4gICAgY2FyZENyZWF0b3JQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxub3BlblByb2ZpbGVFZGl0UG9wdXBCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGZvcm1WYWxpZGF0b3JzW1wicHJvZmlsZUVkaXRGb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gICAgY29uc3QgZGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgICBwcm9maWxlRWRpdFBvcHVwLm9wZW4oKTtcclxuXHJcbiAgICBwcm9maWxlTmFtZUlucHV0LnZhbHVlID0gZGF0YS5wcm9maWxlTmFtZTtcclxuICAgIHByb2ZpbGVBYm91dElucHV0LnZhbHVlID0gZGF0YS5wcm9maWxlQWJvdXQ7XHJcbn0pO1xyXG5cclxub3BlblByb2ZpbGVBdmF0YXJFZGl0UG9wdXBCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGZvcm1WYWxpZGF0b3JzW1wicHJvZmlsZUF2YXRhckVkaXRGb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gICAgZm9ybVZhbGlkYXRvcnNbXCJwcm9maWxlQXZhdGFyRWRpdEZvcm1cIl0ucmVzZXRGb3JtSW5wdXRzKCk7XHJcbiAgICBwcm9maWxlQXZhdGFyRWRpdFBvcHVwLm9wZW4oKTtcclxufSk7IiwiY2xhc3MgQXBpIHtcclxuICAgIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICAgICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdEFsbFByb21pc2UgPSAoKSA9PiBQcm9taXNlLmFsbChbdGhpcy5nZXRJbml0aWFsQ2FyZHMoKSwgdGhpcy5nZXRVc2VySW5mbygpXSlcclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZGVmYXVsdEZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIHVwbG9hZFVzZXJJbmZvKGRhdGEpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZGVmYXVsdEZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIHVwbG9hZFByb2ZpbGVBdmF0YXIodXJsKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RlZmF1bHRGZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7YXZhdGFyOiB1cmx9KSxcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9kZWZhdWx0RmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgdXBsb2FkQ2FyZChkYXRhKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RlZmF1bHRGZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RlZmF1bHRGZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgbGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RlZmF1bHRGZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZGlzbGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RlZmF1bHRGZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgX2RlZmF1bHRGZXRjaCA9IChiYXNlVXJsLCBzZXR0aW5ncykgPT5cclxuICAgICAgICBmZXRjaChiYXNlVXJsLCBzZXR0aW5ncylcclxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgICAgIGlmKHJlcy5vaykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXMpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGBFcnJvcjogJHtlcnJ9YCkpO1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBBcGk7XHJcblxyXG4iLCJjbGFzcyBVc2VySW5mbyB7XHJcbiAgICBjb25zdHJ1Y3RvcihkYXRhKSB7XHJcbiAgICAgICAgY29uc3QgeyB1c2VyTmFtZUVsZW1lbnQsIHVzZXJBYm91dEVsZW1lbnQsIHVzZXJBdmF0YXJFbGVtZW50IH0gPSBkYXRhO1xyXG4gICAgICAgIHRoaXMuX3VzZXJOYW1lID0gdXNlck5hbWVFbGVtZW50O1xyXG4gICAgICAgIHRoaXMuX3VzZXJBYm91dCA9IHVzZXJBYm91dEVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5fdXNlckF2YXRhciA9IHVzZXJBdmF0YXJFbGVtZW50O1xyXG4gICAgfVxyXG5cclxuICAgIGdldFVzZXJJbmZvID0gKCkgPT4ge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHByb2ZpbGVOYW1lOiB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgICAgICAgcHJvZmlsZUFib3V0OiB0aGlzLl91c2VyQWJvdXQudGV4dENvbnRlbnRcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VXNlckluZm8gPSAoZGF0YSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHsgbmFtZSwgYWJvdXQsIGlkIH0gPSBkYXRhO1xyXG5cclxuICAgICAgICB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5fdXNlckFib3V0LnRleHRDb250ZW50ID0gYWJvdXQ7XHJcbiAgICAgICAgdGhpcy5fdXNlcklkID0gaWQ7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VXNlckF2YXRhciA9ICh1cmwpID0+IHtcclxuICAgICAgICB0aGlzLl91c2VyQXZhdGFyLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoXCIke3VybH1cIilgO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBVc2VySW5mbzsiLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuaW1wb3J0IHsgY2FyZFByZXZpZXdQb3B1cEVsZW1lbnRzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50c1wiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBvcGVuID0gKGRhdGEpID0+IHtcclxuICAgICAgICBjb25zdCB7IG5hbWUsIGxpbmsgfSA9IGRhdGE7XHJcbiAgICAgICAgY29uc3QgeyBjYXJkUHJldmlld1BvcHVwVGl0bGUsIGNhcmRQcmV2aWV3UG9wdXBJbWFnZSB9ID0gY2FyZFByZXZpZXdQb3B1cEVsZW1lbnRzO1xyXG5cclxuICAgICAgICBjYXJkUHJldmlld1BvcHVwVGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgICAgIGNhcmRQcmV2aWV3UG9wdXBJbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgICAgIGNhcmRQcmV2aWV3UG9wdXBJbWFnZS5hbHQgPSBgUGhvdG8gb2YgJHtsaW5rfWA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTsiLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmNsYXNzIENvbmZpcm1Qb3B1cCBleHRlbmRzIFBvcHVwIHtcclxuICAgIHNldEFjdGlvbiA9IChhY3Rpb24pID0+IHtcclxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b25IYW5kbGVyID0gYWN0aW9uO1xyXG4gICAgfVxyXG4gICAgb3BlbiA9ICgpID0+IHtcclxuICAgICAgICBzdXBlci5vcGVuKCk7XHJcbiAgICAgICAgdGhpcy5hZGRDb25maXJtQnV0dG9uTGlzdGVuZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgICAgIHRoaXMucmVtb3ZlQ29uZmlybUJ1dHRvbkxpc3RlbmVyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkQ29uZmlybUJ1dHRvbkxpc3RlbmVyID0gKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVBvcHVwQ29uZmlybUJ1dHRvbik7XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlQ29uZmlybUJ1dHRvbkxpc3RlbmVyID0gKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVBvcHVwQ29uZmlybUJ1dHRvbik7XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZVBvcHVwQ29uZmlybUJ1dHRvbiA9IChldnQpID0+IHtcclxuICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b25IYW5kbGVyKCk7XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDb25maXJtUG9wdXA7IiwiY2xhc3MgU2VjdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7IHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBjb250YWluZXJTZWxlY3RvcjtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJJdGVtcyhyZW5kZXJJdGVtcykge1xyXG4gICAgICAgIHJlbmRlckl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZEl0ZW1Ub0VuZChlbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZChlbGVtZW50KTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRJdGVtVG9CZWdpbihlbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFNlY3Rpb247IiwiY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7ZGF0YSwgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVEZWxldGVDYXJkLCBoYW5kbGVMaWtlQ2FyZH0sIGNhcmRUZW1wbGF0ZVNlbGVjdG9yLCB1c2VySWQpIHtcclxuICAgICAgICBjb25zdCB7IG5hbWUsIGxpbmssIGxpa2VzID0gW10sIG93bmVyID0ge30gfSA9IGRhdGE7XHJcbiAgICAgICAgdGhpcy5fbmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5fbGluayA9IGxpbms7XHJcbiAgICAgICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcclxuICAgICAgICB0aGlzLl9vd25lcklkID0gb3duZXIuX2lkO1xyXG5cclxuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZURlbGV0ZUNhcmQ7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZUNhcmQgPSBoYW5kbGVMaWtlQ2FyZDtcclxuICAgICAgICB0aGlzLl9jYXJkVGVtcGxhdGVTZWxlY3RvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY2FyZFRlbXBsYXRlU2VsZWN0b3IpLmNvbnRlbnQ7XHJcbiAgICAgICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG4gICAgICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fY2FyZFRlbXBsYXRlU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5jYXJkc19faXRlbVwiKS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fZGVsZXRlLWJ1dHRvblwiKTtcclxuICAgICAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlrZS1idXR0b25cIik7XHJcbiAgICAgICAgdGhpcy5fbGlrZXNBbW91bnQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saWtlcy1hbW91bnRcIik7XHJcblxyXG4gICAgICAgIGlmKHRoaXMuX293bmVySWQgPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX293bmVySWQgPSB1c2VySWQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZSgpIHtcclxuICAgICAgICBjb25zdCBjYXJkID0ge1xyXG4gICAgICAgICAgICBpbWFnZTogdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fcGhvdG9cIiksXHJcbiAgICAgICAgICAgIG5hbWU6IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX25hbWVcIiksXHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgY2FyZC5pbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgICAgIGNhcmQubmFtZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICAgICAgY2FyZC5pbWFnZS5hbHQgPSBgUGhvdG8gb2YgJHt0aGlzLl9uYW1lfWA7XHJcblxyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKGNhcmQuaW1hZ2UpO1xyXG5cclxuICAgICAgICBpZih0aGlzLl9vd25lcklkICE9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19kZWxldGUtYnV0dG9uX2hpZGRlblwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX2xpa2VzQW1vdW50LnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG5cclxuICAgICAgICBpZih0aGlzLmlzTGlrZWQoKSkge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUxpa2VzKHRoaXMuX2xpa2VzKTtcclxuICAgICAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi50aXRsZSA9IFwiRGlzbGlrZVwiO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGUgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGlzTGlrZWQgPSAoKSA9PiB0aGlzLl9saWtlcy5zb21lKHVzZXIgPT4gdXNlci5faWQgPT09IHRoaXMuX3VzZXJJZCk7XHJcblxyXG4gICAgdXBkYXRlTGlrZXMgPSAobGlrZXMpID0+IHtcclxuICAgICAgICB0aGlzLl9saWtlcyA9IGxpa2VzO1xyXG4gICAgICAgIHRoaXMuX2xpa2VzQW1vdW50LnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRzX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX3Bob3RvXCIpO1xyXG5cclxuICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVMaWtlQ2FyZCk7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKTtcclxuICAgICAgICBjYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUNhcmRDbGljayk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IENhcmQ7IiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IHtcclxuICAgICAgICAgICAgaW5wdXRFcnJvckNsYXNzLFxyXG4gICAgICAgICAgICBlcnJvckNsYXNzXHJcbiAgICAgICAgfSA9IHRoaXMuX2NvbmZpZzsgXHJcblxyXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChpbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChlcnJvckNsYXNzKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3Qge1xyXG4gICAgICAgICAgICBpbnB1dEVycm9yQ2xhc3MsXHJcbiAgICAgICAgICAgIGVycm9yQ2xhc3NcclxuICAgICAgICB9ID0gdGhpcy5fY29uZmlnO1xyXG5cclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShlcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAgICAgaWYoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9oYXNJbnZhbGlkSW5wdXQgPSAoKSA9PiB0aGlzLl9pbnB1dExpc3Quc29tZShpbnB1dEVsZW1lbnQgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XHJcblxyXG4gICAgX3RvZ2dsZUJ1dHRvblN0YXRlKGJ1dHRvbkVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCB7IGluYWN0aXZlQnV0dG9uQ2xhc3MgfSA9IHRoaXMuX2NvbmZpZztcclxuICAgIFxyXG4gICAgICAgIGlmKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgICAgICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChpbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgICAgICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICAgICAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBjb25zdCB7IGlucHV0U2VsZWN0b3IsIHN1Ym1pdEJ1dHRvblNlbGVjdG9yIH0gPSB0aGlzLl9jb25maWc7XHJcbiAgICBcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoaW5wdXRTZWxlY3RvcikpO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgIFxyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKGlucHV0RWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9idXR0b25FbGVtZW50KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGV2dCA9PiBldnQucHJldmVudERlZmF1bHQoKSk7XHJcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgICAgICB0aGlzLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChpbnB1dEVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0Rm9ybUlucHV0cygpIHtcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKHRoaXMuX2J1dHRvbkVsZW1lbnQpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xyXG4iXSwibmFtZXMiOlsiY29uZmlnIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJjYXJkUHJldmlld1BvcHVwIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2FyZENyZWF0b3JQb3B1cEVsZW1lbnQiLCJwcm9maWxlRWRpdFBvcHVwRWxlbWVudCIsInByb2ZpbGVBdmF0YXJFZGl0UG9wdXBFbGVtZW50IiwicG9wdXBDb25maXJtRWxlbWVudCIsInByb2ZpbGVJbmZvRWxlbWVudHMiLCJwcm9maWxlTmFtZSIsInByb2ZpbGVBYm91dCIsInByb2ZpbGVBdmF0YXIiLCJjYXJkR3JpZCIsImNhcmRQcmV2aWV3UG9wdXBFbGVtZW50cyIsImNhcmRQcmV2aWV3UG9wdXBJbWFnZSIsImNhcmRQcmV2aWV3UG9wdXBUaXRsZSIsImNsb3NlQ2FyZFByZXZpZXdQb3B1cEJ1dHRvbiIsImNvbmZpcm1Qb3B1cEVsZW1lbnRzIiwiY2FyZENyZWF0b3JQb3B1cEVsZW1lbnRzIiwib3BlbkNhcmRDcmVhdG9yUG9wdXBCdXR0b24iLCJnZXRFbGVtZW50QnlJZCIsInByb2ZpbGVFZGl0UG9wdXBFbGVtZW50cyIsInByb2ZpbGVOYW1lSW5wdXQiLCJwcm9maWxlQWJvdXRJbnB1dCIsIm9wZW5Qcm9maWxlRWRpdFBvcHVwQnV0dG9uIiwicHJvZmlsZUF2YXRhckVkaXRQb3B1cEVsZW1lbnRzIiwicHJvZmlsZUF2YXRhckxpbmtJbnB1dCIsIm9wZW5Qcm9maWxlQXZhdGFyRWRpdFBvcHVwQnV0dG9uIiwiZm9ybVZhbGlkYXRvcnMiLCJjb25zdHJ1Y3RvciIsInBvcHVwRWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0aGlzIiwiX2hhbmRsZUVzY0Nsb3NlIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVSZW1vdGVDbGljayIsIl9oYW5kbGVDbG9zZUJ1dHRvbiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJjbG9zZSIsIm91dHNpZGVFbGVtZW50IiwidGFyZ2V0IiwiaXNFcXVhbE5vZGUiLCJvcGVuIiwiY2xhc3NMaXN0IiwiYWRkIiwiX2FkZEV2ZW50TGlzdGVuZXJzIiwicmVtb3ZlIiwiX3JlbW92ZUV2ZW50TGlzdGVuZXJzIiwiUG9wdXAiLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfZm9ybUVsZW1lbnQiLCJfaGFuZGxlUG9wdXBGb3JtU3VibWl0IiwicHJldmVudERlZmF1bHQiLCJfc3VibWl0QnV0dG9uIiwidGV4dENvbnRlbnQiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsImRhdGEiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImlucHV0IiwibmFtZSIsInZhbHVlIiwiYWRkU3VibWl0QnV0dG9uTGlzdGVuZXIiLCJyZW1vdmVTdWJtaXRCdXR0b25MaXN0ZW5lciIsInVzZXJJZCIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiUHJvbWlzZSIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwic2V0dGluZ3MiLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJyZWplY3QiLCJzdGF0dXMiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2RlZmF1bHRGZXRjaCIsIm1ldGhvZCIsInVwbG9hZFVzZXJJbmZvIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1cGxvYWRQcm9maWxlQXZhdGFyIiwidXJsIiwiYXZhdGFyIiwidXBsb2FkQ2FyZCIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsImRpc2xpa2VDYXJkIiwiYXV0aG9yaXphdGlvbiIsImluaXRBbGxQcm9taXNlIiwiY2FyZHMiLCJ1c2VyIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsImpvYiIsImFib3V0IiwiaWQiLCJfaWQiLCJzZXRVc2VyQXZhdGFyIiwiY2FyZExpc3QiLCJyZW5kZXJJdGVtcyIsIl91c2VyTmFtZSIsIl91c2VyQWJvdXQiLCJfdXNlcklkIiwiX3VzZXJBdmF0YXIiLCJzdHlsZSIsImJhY2tncm91bmRJbWFnZSIsInVzZXJOYW1lRWxlbWVudCIsInVzZXJBYm91dEVsZW1lbnQiLCJ1c2VyQXZhdGFyRWxlbWVudCIsInBvcHVwSW1hZ2VQcmV2aWV3IiwibGluayIsInNyYyIsImFsdCIsInBvcHVwQ29uZmlybSIsImFjdGlvbiIsIl9zdWJtaXRCdXR0b25IYW5kbGVyIiwiYWRkQ29uZmlybUJ1dHRvbkxpc3RlbmVyIiwiX2hhbmRsZVBvcHVwQ29uZmlybUJ1dHRvbiIsInJlbW92ZUNvbmZpcm1CdXR0b25MaXN0ZW5lciIsImNvbnRhaW5lclNlbGVjdG9yIiwicmVuZGVyZXIiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiaXRlbSIsImFkZEl0ZW1Ub0VuZCIsImVsZW1lbnQiLCJhcHBlbmQiLCJhZGRJdGVtVG9CZWdpbiIsInByZXBlbmQiLCJjcmVhdGVDYXJkIiwiY2FyZCIsImNhcmRUZW1wbGF0ZVNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImhhbmRsZUxpa2VDYXJkIiwiX2NhcmRFbGVtZW50IiwiX2xpa2VzIiwic29tZSIsImxpa2VzIiwiX2xpa2VzQW1vdW50IiwibGVuZ3RoIiwiX2xpa2VCdXR0b24iLCJ0b2dnbGUiLCJjYXJkSW1hZ2UiLCJfaGFuZGxlTGlrZUNhcmQiLCJfZGVsZXRlQnV0dG9uIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJfaGFuZGxlQ2FyZENsaWNrIiwib3duZXIiLCJfbmFtZSIsIl9saW5rIiwiX293bmVySWQiLCJfY2FyZFRlbXBsYXRlU2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwidW5kZWZpbmVkIiwiY3JlYXRlIiwiaW1hZ2UiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJpc0xpa2VkIiwidXBkYXRlTGlrZXMiLCJ0aXRsZSIsInNldEFjdGlvbiIsImRlbGV0ZSIsImNhcmRDcmVhdG9yUG9wdXAiLCJQb3B1cFdpdGhGb3JtIiwiYnV0dG9uIiwiZmluYWxseSIsInNldFRpbWVvdXQiLCJwcm9maWxlRWRpdFBvcHVwIiwicHJvZmlsZUF2YXRhckVkaXRQb3B1cCIsImZvcm0iLCJ2YWxpZGF0b3IiLCJmb3JtRWxlbWVudCIsIl9pbnB1dExpc3QiLCJpbnB1dEVsZW1lbnQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NvbmZpZyIsIl9zaG93SW5wdXRFcnJvciIsImVycm9yRWxlbWVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImJ1dHRvbkVsZW1lbnQiLCJfaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZWQiLCJBcnJheSIsImZyb20iLCJfYnV0dG9uRWxlbWVudCIsImVuYWJsZVZhbGlkYXRpb24iLCJyZXNldFZhbGlkYXRpb24iLCJyZXNldEZvcm1JbnB1dHMiLCJyZXNldCIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIl0sInNvdXJjZVJvb3QiOiIifQ==